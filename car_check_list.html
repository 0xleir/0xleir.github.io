<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æˆ‘çš„i6æ£€æŸ¥</title>
  <style>
    /* CSS å˜é‡å®šä¹‰ */
    :root {
      --primary-color: #2563eb;
      --success-color: #10b981;
      --background: #f9fafb;
      --card-background: #ffffff;
      --text-primary: #111827;
      --text-secondary: #6b7280;
      --border-color: #e5e7eb;
      --danger-color: #ef4444;
      
      /* é—´è· */
      --spacing-xs: 0.25rem;
      --spacing-sm: 0.5rem;
      --spacing-md: 1rem;
      --spacing-lg: 1.5rem;
      --spacing-xl: 2rem;
      
      /* å­—ä½“å¤§å° - ç§»åŠ¨ä¼˜å…ˆ */
      --font-size-sm: 0.875rem;
      --font-size-base: 0.875rem; /* 14px ç§»åŠ¨ç«¯æœ€å° */
      --font-size-lg: 1rem;
      --font-size-xl: 1.125rem;
      --font-size-2xl: 1.5rem;
      
      /* è§¦æ‘¸ç›®æ ‡æœ€å°å°ºå¯¸ */
      --touch-target-min: 44px;
      
      /* è¾¹æ¡†åœ†è§’ */
      --border-radius-sm: 0.25rem;
      --border-radius-md: 0.5rem;
      --border-radius-lg: 0.75rem;
    }
    
    /* å…¨å±€æ ·å¼é‡ç½® */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      font-size: var(--font-size-base);
      line-height: 1.6;
      color: var(--text-primary);
      background-color: var(--background);
      padding: var(--spacing-md);
    }
    
    /* ä¸»å®¹å™¨ */
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    /* å¤´éƒ¨æ ·å¼ */
    .header {
      background-color: var(--card-background);
      padding: var(--spacing-lg);
      border-radius: var(--border-radius-lg);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      margin-bottom: var(--spacing-lg);
    }
    
    .header h1 {
      font-size: var(--font-size-xl);
      color: var(--text-primary);
      margin-bottom: var(--spacing-md);
      text-align: center;
    }
    
    /* è¿›åº¦æ˜¾ç¤ºåŒºåŸŸ */
    .progress-section {
      margin-top: var(--spacing-md);
    }
    
    .progress-text {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--spacing-sm);
      font-size: var(--font-size-base);
      color: var(--text-secondary);
    }
    
    .progress-percentage {
      font-weight: 600;
      color: var(--primary-color);
      font-size: var(--font-size-lg);
    }
    
    /* è¿›åº¦æ¡ */
    .progress-bar-container {
      width: 100%;
      height: 12px;
      background-color: var(--border-color);
      border-radius: var(--border-radius-lg);
      overflow: hidden;
    }
    
    .progress-bar-fill {
      height: 100%;
      background-color: var(--success-color);
      transition: width 0.3s ease;
      border-radius: var(--border-radius-lg);
    }
    
    /* æ£€æŸ¥æ¸…å•ä¸»åŒºåŸŸ */
    .checklist-container {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-lg);
      min-height: 400px;
      position: relative;
    }
    
    /* å•é¡¹å¡ç‰‡è§†å›¾ */
    .single-item-card {
      background-color: var(--card-background);
      border-radius: var(--border-radius-lg);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      padding: var(--spacing-xl);
      display: none;
      animation: fadeIn 0.3s ease-in;
    }
    
    .single-item-card.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* åˆ†ç±»æ ‡ç­¾ */
    .category-badge {
      display: inline-block;
      background-color: var(--primary-color);
      color: white;
      padding: var(--spacing-xs) var(--spacing-md);
      border-radius: var(--border-radius-md);
      font-size: var(--font-size-sm);
      font-weight: 600;
      margin-bottom: var(--spacing-md);
    }
    
    /* æ£€æŸ¥é¡¹å†…å®¹ */
    .item-content {
      margin-bottom: var(--spacing-lg);
    }
    
    .item-text {
      font-size: var(--font-size-xl);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--spacing-md);
      line-height: 1.4;
    }
    
    .item-hint {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: var(--spacing-lg);
      padding: var(--spacing-md);
      background-color: var(--background);
      border-radius: var(--border-radius-md);
      border-left: 3px solid var(--primary-color);
    }
    
    /* å¤é€‰æ¡†åŒºåŸŸ */
    .checkbox-section {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      padding: var(--spacing-lg);
      background-color: var(--background);
      border-radius: var(--border-radius-md);
      margin-bottom: var(--spacing-lg);
      min-height: var(--touch-target-min);
    }
    
    .checkbox-section input[type="checkbox"] {
      width: 28px;
      height: 28px;
      cursor: pointer;
      accent-color: var(--success-color);
      flex-shrink: 0;
    }
    
    .checkbox-label {
      font-size: var(--font-size-lg);
      color: var(--text-primary);
      cursor: pointer;
      user-select: none;
    }
    
    .checkbox-label.completed {
      color: var(--success-color);
      font-weight: 600;
    }
    
    /* å¤‡æ³¨è¾“å…¥æ¡† */
    .note-input {
      width: 100%;
      padding: var(--spacing-md);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius-md);
      font-size: var(--font-size-base);
      font-family: inherit;
      background-color: var(--card-background);
      color: var(--text-primary);
      min-height: 80px;
      resize: vertical;
      transition: border-color 0.2s, background-color 0.2s;
      margin-bottom: var(--spacing-lg);
    }
    
    .note-input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    .note-input::placeholder {
      color: var(--text-secondary);
    }
    
    /* å¯¼èˆªæŒ‰é’® */
    .navigation-buttons {
      display: flex;
      gap: var(--spacing-md);
      justify-content: space-between;
    }
    
    .nav-btn {
      flex: 1;
      padding: var(--spacing-md) var(--spacing-lg);
      font-size: var(--font-size-base);
      font-weight: 600;
      border: none;
      border-radius: var(--border-radius-md);
      cursor: pointer;
      min-height: var(--touch-target-min);
      transition: all 0.2s;
      font-family: inherit;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-sm);
    }
    
    .nav-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .nav-btn-prev {
      background-color: var(--border-color);
      color: var(--text-primary);
    }
    
    .nav-btn-prev:hover:not(:disabled) {
      background-color: #d1d5db;
    }
    
    .nav-btn-next {
      background-color: var(--primary-color);
      color: white;
    }
    
    .nav-btn-next:hover:not(:disabled) {
      background-color: #1d4ed8;
    }
    
    .nav-btn:active:not(:disabled) {
      transform: scale(0.98);
    }
    
    /* è¿›åº¦æŒ‡ç¤ºå™¨ */
    .item-progress {
      text-align: center;
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      margin-top: var(--spacing-md);
    }
    
    /* æ—§ç‰ˆæ ·å¼ä¿ç•™ï¼ˆç”¨äºé‡ç½®åçš„å…¨åˆ—è¡¨è§†å›¾ï¼‰ */
    .category-card {
      background-color: var(--card-background);
      border-radius: var(--border-radius-lg);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      display: none;
    }
    
    .category-header {
      padding: var(--spacing-lg);
      background-color: var(--primary-color);
      color: white;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      min-height: var(--touch-target-min);
    }
    
    .category-title {
      font-size: var(--font-size-lg);
      font-weight: 600;
    }
    
    .category-progress {
      font-size: var(--font-size-sm);
      opacity: 0.9;
    }
    
    .category-items {
      padding: var(--spacing-md);
    }
    
    /* æ£€æŸ¥é¡¹ */
    .check-item {
      padding: var(--spacing-md);
      border-bottom: 1px solid var(--border-color);
    }
    
    .check-item:last-child {
      border-bottom: none;
    }
    
    .check-item-row {
      display: flex;
      align-items: flex-start;
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-sm);
    }
    
    /* å¤é€‰æ¡†æ ·å¼ */
    .checkbox-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: var(--touch-target-min);
      min-height: var(--touch-target-min);
      flex-shrink: 0;
    }
    
    input[type="checkbox"] {
      width: 24px;
      height: 24px;
      cursor: pointer;
      accent-color: var(--success-color);
    }
    
    .check-item-label {
      flex: 1;
      font-size: var(--font-size-base);
      color: var(--text-primary);
      line-height: 1.5;
      padding-top: 10px;
    }
    
    .check-item-label.completed {
      color: var(--text-secondary);
      text-decoration: line-through;
    }
    
    /* åº•éƒ¨æ“ä½œåŒº */
    .footer {
      margin-top: var(--spacing-xl);
      padding: var(--spacing-lg);
      background-color: var(--card-background);
      border-radius: var(--border-radius-lg);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      text-align: center;
    }
    
    /* æŒ‰é’®æ ·å¼ */
    .btn {
      padding: var(--spacing-md) var(--spacing-xl);
      font-size: var(--font-size-base);
      font-weight: 600;
      border: none;
      border-radius: var(--border-radius-md);
      cursor: pointer;
      min-height: var(--touch-target-min);
      min-width: var(--touch-target-min);
      transition: background-color 0.2s, transform 0.1s;
      font-family: inherit;
    }
    
    .btn:active {
      transform: scale(0.98);
    }
    
    .btn-danger {
      background-color: var(--card-background);
      color: var(--danger-color);
      border: 2px solid var(--danger-color);
    }
    
    .btn-danger:hover {
      background-color: var(--danger-color);
      color: white;
    }
    
    /* åº†ç¥åŠ¨ç”»è¦†ç›–å±‚ */
    .celebration-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(37, 99, 235, 0.9), rgba(16, 185, 129, 0.9));
      z-index: 2000;
      align-items: center;
      justify-content: center;
      padding: var(--spacing-md);
      animation: fadeIn 0.5s ease-in;
    }
    
    .celebration-overlay.active {
      display: flex;
    }
    
    .celebration-content {
      text-align: center;
      color: white;
      max-width: 600px;
      animation: scaleIn 0.6s ease-out;
    }
    
    @keyframes scaleIn {
      from {
        opacity: 0;
        transform: scale(0.8);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }
    
    .celebration-icon {
      font-size: 5rem;
      margin-bottom: var(--spacing-lg);
      animation: bounce 1s ease-in-out infinite;
    }
    
    @keyframes bounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-20px);
      }
    }
    
    .celebration-title {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: var(--spacing-md);
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .celebration-message {
      font-size: 1.25rem;
      margin-bottom: var(--spacing-xl);
      line-height: 1.6;
      opacity: 0.95;
    }
    
    .celebration-stats {
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: var(--border-radius-lg);
      padding: var(--spacing-lg);
      margin-bottom: var(--spacing-xl);
      backdrop-filter: blur(10px);
    }
    
    .celebration-stat {
      font-size: 1.5rem;
      font-weight: 600;
      margin: var(--spacing-sm) 0;
    }
    
    .celebration-close-btn {
      background-color: white;
      color: var(--primary-color);
      padding: var(--spacing-md) var(--spacing-xl);
      font-size: var(--font-size-lg);
      font-weight: 600;
      border: none;
      border-radius: var(--border-radius-md);
      cursor: pointer;
      min-height: var(--touch-target-min);
      transition: all 0.2s;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    }
    
    .celebration-close-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
    }
    
    /* çƒŸèŠ±æ•ˆæœ */
    .firework {
      position: absolute;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      animation: firework 1.5s ease-out forwards;
    }
    
    @keyframes firework {
      0% {
        opacity: 1;
        transform: translate(0, 0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translate(var(--tx), var(--ty)) scale(0);
      }
    }
    
    /* ç¡®è®¤å¯¹è¯æ¡† */
    .dialog-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: var(--spacing-md);
    }
    
    .dialog-overlay.active {
      display: flex;
    }
    
    .dialog {
      background-color: var(--card-background);
      border-radius: var(--border-radius-lg);
      padding: var(--spacing-xl);
      max-width: 400px;
      width: 100%;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .dialog-title {
      font-size: var(--font-size-xl);
      font-weight: 600;
      margin-bottom: var(--spacing-md);
      color: var(--text-primary);
    }
    
    .dialog-message {
      font-size: var(--font-size-base);
      color: var(--text-secondary);
      margin-bottom: var(--spacing-xl);
      line-height: 1.6;
    }
    
    .dialog-actions {
      display: flex;
      gap: var(--spacing-md);
      justify-content: flex-end;
    }
    
    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #1d4ed8;
    }
    
    .btn-secondary {
      background-color: var(--border-color);
      color: var(--text-primary);
    }
    
    .btn-secondary:hover {
      background-color: #d1d5db;
    }
    
    /* å“åº”å¼è®¾è®¡ - å¹³æ¿å’Œæ¡Œé¢ */
    @media (min-width: 768px) {
      :root {
        --font-size-base: 1rem; /* 16px æ¡Œé¢ç«¯ */
        --font-size-lg: 1.125rem;
        --font-size-xl: 1.25rem;
        --font-size-2xl: 1.875rem;
      }
      
      body {
        padding: var(--spacing-xl);
      }
      
      .header h1 {
        font-size: var(--font-size-2xl);
      }
      
      .category-title {
        font-size: var(--font-size-xl);
      }
      
      .check-item-label {
        font-size: var(--font-size-lg);
      }
      
      /* æ¡Œé¢ç«¯å¯ä»¥ä½¿ç”¨æ›´å®½æ¾çš„é—´è· */
      .header {
        padding: var(--spacing-xl);
      }
      
      .category-header {
        padding: var(--spacing-xl);
      }
      
      .category-items {
        padding: var(--spacing-lg);
      }
      
      .check-item {
        padding: var(--spacing-lg);
      }
    }
    
    /* æ‰“å°æ ·å¼ */
    @media print {
      body {
        background-color: white;
      }
      
      .footer {
        display: none;
      }
      
      .category-card {
        page-break-inside: avoid;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- å¤´éƒ¨å’Œè¿›åº¦åŒºåŸŸ -->
    <header class="header">
      <h1>æˆ‘çš„i6æ£€æŸ¥</h1>
      <div class="progress-section">
        <div class="progress-text">
          <span>æ£€æŸ¥è¿›åº¦</span>
          <span class="progress-percentage" id="progressPercentage">0%</span>
        </div>
        <div class="progress-bar-container" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="æ£€æŸ¥æ¸…å•å®Œæˆè¿›åº¦">
          <div class="progress-bar-fill" id="progressBarFill" style="width: 0%"></div>
        </div>
        <div class="progress-text" style="margin-top: 0.5rem;">
          <span id="progressText">å·²å®Œæˆ 0 / 0 é¡¹</span>
        </div>
      </div>
    </header>
    
    <!-- æ£€æŸ¥æ¸…å•ä¸»åŒºåŸŸ -->
    <main class="checklist-container" id="checklistContainer">
      <!-- æ£€æŸ¥æ¸…å•å°†é€šè¿‡ JavaScript åŠ¨æ€ç”Ÿæˆ -->
    </main>
    
    <!-- åº•éƒ¨æ“ä½œåŒº -->
    <footer class="footer">
      <button class="btn btn-danger" id="resetButton" aria-label="é‡ç½®æ‰€æœ‰æ£€æŸ¥é¡¹å’Œå¤‡æ³¨">é‡ç½®æ£€æŸ¥æ¸…å•</button>
    </footer>
  </div>
  
  <!-- ç¡®è®¤å¯¹è¯æ¡† -->
  <div class="dialog-overlay" id="dialogOverlay" role="dialog" aria-modal="true" aria-labelledby="dialogTitle">
    <div class="dialog">
      <h2 class="dialog-title" id="dialogTitle">ç¡®è®¤æ“ä½œ</h2>
      <p class="dialog-message" id="dialogMessage">ç¡®å®šè¦æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ</p>
      <div class="dialog-actions">
        <button class="btn btn-secondary" id="dialogCancel">å–æ¶ˆ</button>
        <button class="btn btn-primary" id="dialogConfirm">ç¡®è®¤</button>
      </div>
    </div>
  </div>
  
  <!-- åº†ç¥åŠ¨ç”»è¦†ç›–å±‚ -->
  <div class="celebration-overlay" id="celebrationOverlay">
    <div class="celebration-content">
      <div class="celebration-icon">ğŸ‰</div>
      <h2 class="celebration-title">æ­å–œæè½¦ï¼</h2>
      <p class="celebration-message">
        æ‚¨å·²å®Œæˆæ‰€æœ‰æ£€æŸ¥é¡¹ç›®<br>
        ç¥æ‚¨ç”¨è½¦æ„‰å¿«ï¼Œä¸€è·¯å¹³å®‰ï¼
      </p>
      <div class="celebration-stats" id="celebrationStats">
        <div class="celebration-stat">âœ“ å·²å®Œæˆ <span id="completedCount">0</span> é¡¹æ£€æŸ¥</div>
        <div class="celebration-stat">ğŸ“ æ·»åŠ äº† <span id="notesCount">0</span> æ¡å¤‡æ³¨</div>
      </div>
      <button class="celebration-close-btn" id="celebrationClose">å¤ªå¥½äº†ï¼</button>
    </div>
  </div>
  
  <script>
    // ==================== æ•°æ®å®šä¹‰ ====================
    
    /**
     * æ£€æŸ¥æ¸…å•æ•°æ®ç»“æ„
     * åŒ…å« 6 ä¸ªæ£€æŸ¥åˆ†ç±»ï¼Œæ¯ä¸ªåˆ†ç±»åŒ…å«å¤šä¸ªæ£€æŸ¥é¡¹
     */
    const checklistData = {
      categories: [
         {
          id: 'documents',
          title: 'è¯ä»¶æ£€æŸ¥',
          items: [
            { id: 'doc_1', text: 'è½¦è¾†åˆæ ¼è¯ã€è½¦æ¶å·' },
            { id: 'doc_2', text: 'PDI' },
            { id: 'doc_3', text: 'ä¿å…»æ‰‹å†Œå’Œä½¿ç”¨è¯´æ˜ä¹¦' },
            { id: 'doc_4', text: 'è½¦è¾†é“­ç‰Œä¿¡æ¯' }
          ]
        },
        {
          id: 'exterior',
          title: 'å¤–è§‚æ£€æŸ¥',
          items: [
            { id: 'ext_1', text: 'è½¦èº«æ¼†é¢' },
            { id: 'ext_2', text: 'è½¦é—¨' },
            { id: 'ext_3', text: 'å‰åä¿é™©æ ' },
            { id: 'ext_4', text: 'å¤–éƒ¨ç¯å…‰' },
            { id: 'ext_5', text: 'å¤–åè§†é•œæ£€æŸ¥' },
            { id: 'ext_6', text: 'è½®èƒ' },
            { id: 'ext_7', text: 'è½®æ¯‚' },
            { id: 'ext_8', text: 'å…¨è½¦ç»ç’ƒ' },
            { id: 'ext_9', text: 'å‰åé›¨åˆ·' },
            { id: 'ext_10', text: 'å‰å¤‡ç®±' },
            { id: 'ext_11', text: 'åå¤‡ç®±' }
          ]
        },
        {
          id: 'interior',
          title: 'å†…é¥°æ£€æŸ¥',
          items: [
            { id: 'int_1', text: 'åº§æ¤…å¤–è§‚' },
            { id: 'int_2', text: 'æ–¹å‘ç›˜ã€æ¡£æŠŠæ— ç£¨æŸ' },
            { id: 'int_3', text: 'ä»ªè¡¨ç›˜æ˜¾ç¤ºæ­£å¸¸ï¼Œæ— æ•…éšœç¯' },
            { id: 'int_4', text: 'è½¦å†…å±å¹•' },
            { id: 'int_5', text: 'ç©ºè°ƒ' },
            { id: 'int_6', text: 'å†°ç®±' },
            { id: 'int_7', text: 'è½¦çª—' },
            { id: 'int_8', text: 'åæ’é®é˜³å¸˜' },
            { id: 'int_9', text: 'æ— çº¿å……ç”µ' },
            { id: 'int_10', text: 'åæ’Type-C' },
            { id: 'int_11', text: 'å‰æ’åº§æ¤…' },
            { id: 'int_12', text: 'åæ’åº§æ¤…' },
            { id: 'int_13', text: 'HUD' },
            { id: 'int_14', text: 'éŸ³å“' },
            { id: 'int_15', text: 'å¤©çª—' },
            { id: 'int_16', text: 'è½¦å†…ç¯å…‰' }
          ]
        },
        {
          id: 'mechanical',
          title: 'æœºæ¢°æ£€æŸ¥',
          items: [
            { id: 'mech_1', text: 'æ–¹å‘ç›˜è°ƒèŠ‚' }
          ]
        },
        {
          id: 'accessories',
          title: 'é…ä»¶æ£€æŸ¥',
          items: [
            { id: 'acc_1', text: 'æ‹†è½®èƒå·¥å…·' },
            { id: 'acc_2', text: 'ä¸‰è§’è­¦ç¤ºç‰Œ' },
            { id: 'acc_3', text: 'éšè½¦å·¥å…·åŒ…' },
            { id: 'acc_4', text: 'éšè½¦é’¥åŒ™æ•°é‡ï¼ˆè‡³å°‘2æŠŠï¼‰' },
            { id: 'acc_5', text: 'å……ç”µæµ‹è¯•' }
          ]
        },
        {
          id: 'final',
          title: 'æœ€ç»ˆç¡®è®¤',
          items: [
            { id: 'fin_1', text: 'ç¡®è®¤æ— é‡å¤§é—®é¢˜ï¼Œå¯ä»¥æè½¦' }
          ]
        }
      ]
    };
    
    // ==================== æœ¬åœ°å­˜å‚¨ç®¡ç†å™¨ ====================
    
    /**
     * StorageManager ç±»
     * è´Ÿè´£å¤„ç†æ‰€æœ‰ localStorage ç›¸å…³æ“ä½œ
     * åŒ…æ‹¬æ£€æŸ¥é¡¹çŠ¶æ€ã€å¤‡æ³¨çš„ä¿å­˜å’Œè¯»å–
     */
    class StorageManager {
      /**
       * æ„é€ å‡½æ•°
       * @param {string} storageKey - localStorage ä¸­ä½¿ç”¨çš„é”®å
       */
      constructor(storageKey = 'carChecklistState') {
        this.storageKey = storageKey;
        this.isAvailable = this.checkLocalStorageAvailability();
        
        // å¦‚æœ localStorage ä¸å¯ç”¨ï¼Œæ˜¾ç¤ºè­¦å‘Š
        if (!this.isAvailable) {
          console.warn('localStorage ä¸å¯ç”¨ï¼Œæ•°æ®å°†ä¸ä¼šè¢«ä¿å­˜');
        }
      }
      
      /**
       * æ£€æµ‹ localStorage æ˜¯å¦å¯ç”¨
       * @returns {boolean} æ˜¯å¦å¯ç”¨
       */
      checkLocalStorageAvailability() {
        try {
          const test = '__storage_test__';
          localStorage.setItem(test, test);
          localStorage.removeItem(test);
          return true;
        } catch (e) {
          return false;
        }
      }
      
      /**
       * è·å–å½“å‰å­˜å‚¨çš„æ‰€æœ‰æ•°æ®
       * @returns {Object} åŒ…å« checks å’Œ notes çš„å¯¹è±¡
       */
      _getData() {
        if (!this.isAvailable) {
          return { checks: {}, notes: {} };
        }
        
        try {
          const data = localStorage.getItem(this.storageKey);
          if (!data) {
            return { checks: {}, notes: {} };
          }
          
          const parsed = JSON.parse(data);
          
          // éªŒè¯æ•°æ®ç»“æ„
          if (typeof parsed !== 'object' || parsed === null) {
            console.warn('localStorage æ•°æ®æ ¼å¼æ— æ•ˆï¼Œå·²é‡ç½®');
            this.resetAll();
            return { checks: {}, notes: {} };
          }
          
          // ç¡®ä¿ checks å’Œ notes å­—æ®µå­˜åœ¨ä¸”ä¸ºå¯¹è±¡
          const checks = (typeof parsed.checks === 'object' && parsed.checks !== null) ? parsed.checks : {};
          const notes = (typeof parsed.notes === 'object' && parsed.notes !== null) ? parsed.notes : {};
          
          return { checks, notes };
        } catch (e) {
          if (e instanceof SyntaxError) {
            console.error('localStorage æ•°æ®è§£æå¤±è´¥ï¼ˆJSON æ ¼å¼é”™è¯¯ï¼‰:', e);
          } else if (e.name === 'SecurityError') {
            console.error('æ— æ³•è®¿é—® localStorageï¼ˆå®‰å…¨é™åˆ¶ï¼‰:', e);
          } else {
            console.error('è¯»å– localStorage æ•°æ®å¤±è´¥:', e);
          }
          
          // æ•°æ®æŸåæˆ–æ— æ³•è®¿é—®ï¼Œè¿”å›ç©ºçŠ¶æ€
          return { checks: {}, notes: {} };
        }
      }
      
      /**
       * ä¿å­˜æ•°æ®åˆ° localStorage
       * @param {Object} data - è¦ä¿å­˜çš„æ•°æ®å¯¹è±¡
       */
      _saveData(data) {
        if (!this.isAvailable) {
          return;
        }
        
        try {
          const dataToSave = {
            checks: data.checks || {},
            notes: data.notes || {},
            lastUpdated: Date.now()
          };
          localStorage.setItem(this.storageKey, JSON.stringify(dataToSave));
        } catch (e) {
          if (e.name === 'QuotaExceededError') {
            console.error('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œè¯·æ¸…ç†æµè§ˆå™¨æ•°æ®');
            alert('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œæ— æ³•ä¿å­˜æ•°æ®ã€‚è¯·æ¸…ç†æµè§ˆå™¨æ•°æ®åé‡è¯•ã€‚');
          } else if (e.name === 'SecurityError') {
            console.error('æ— æ³•è®¿é—® localStorageï¼Œå¯èƒ½æ˜¯éšç§æ¨¡å¼');
            alert('æ— æ³•ä¿å­˜æ•°æ®ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®ï¼ˆå¯èƒ½å¤„äºéšç§æ¨¡å¼ï¼‰ã€‚');
          } else {
            console.error('ä¿å­˜æ•°æ®å¤±è´¥:', e);
          }
        }
      }
      
      /**
       * ä¿å­˜æ£€æŸ¥é¡¹çš„å®ŒæˆçŠ¶æ€
       * @param {string} itemId - æ£€æŸ¥é¡¹ ID
       * @param {boolean} isChecked - æ˜¯å¦å·²å®Œæˆ
       */
      saveCheckState(itemId, isChecked) {
        const data = this._getData();
        data.checks[itemId] = isChecked;
        this._saveData(data);
      }
      
      /**
       * è·å–æ£€æŸ¥é¡¹çš„å®ŒæˆçŠ¶æ€
       * @param {string} itemId - æ£€æŸ¥é¡¹ ID
       * @returns {boolean} æ˜¯å¦å·²å®Œæˆ
       */
      getCheckState(itemId) {
        const data = this._getData();
        return data.checks[itemId] === true;
      }
      
      /**
       * ä¿å­˜æ£€æŸ¥é¡¹çš„å¤‡æ³¨
       * @param {string} itemId - æ£€æŸ¥é¡¹ ID
       * @param {string} noteText - å¤‡æ³¨å†…å®¹
       */
      saveNote(itemId, noteText) {
        const data = this._getData();
        if (noteText && noteText.trim()) {
          data.notes[itemId] = noteText.trim();
        } else {
          // å¦‚æœå¤‡æ³¨ä¸ºç©ºï¼Œåˆ é™¤è¯¥é¡¹
          delete data.notes[itemId];
        }
        this._saveData(data);
      }
      
      /**
       * è·å–æ£€æŸ¥é¡¹çš„å¤‡æ³¨
       * @param {string} itemId - æ£€æŸ¥é¡¹ ID
       * @returns {string} å¤‡æ³¨å†…å®¹
       */
      getNote(itemId) {
        const data = this._getData();
        return data.notes[itemId] || '';
      }
      
      /**
       * è·å–æ‰€æœ‰çŠ¶æ€æ•°æ®
       * @returns {Object} åŒ…å« checks å’Œ notes çš„å®Œæ•´çŠ¶æ€å¯¹è±¡
       */
      getAllStates() {
        return this._getData();
      }
      
      /**
       * é‡ç½®æ‰€æœ‰æ•°æ®
       * æ¸…é™¤æ‰€æœ‰æ£€æŸ¥é¡¹çŠ¶æ€å’Œå¤‡æ³¨
       */
      resetAll() {
        if (!this.isAvailable) {
          return;
        }
        
        try {
          localStorage.removeItem(this.storageKey);
        } catch (e) {
          console.error('æ¸…é™¤æ•°æ®å¤±è´¥:', e);
        }
      }
      
      /**
       * è®¡ç®—å®Œæˆè¿›åº¦
       * @param {number} totalItems - æ€»æ£€æŸ¥é¡¹æ•°é‡
       * @returns {Object} åŒ…å« completedï¼ˆå·²å®Œæˆæ•°ï¼‰ã€totalï¼ˆæ€»æ•°ï¼‰ã€percentageï¼ˆç™¾åˆ†æ¯”ï¼‰
       */
      calculateProgress(totalItems) {
        const data = this._getData();
        const checks = data.checks;
        
        // ç»Ÿè®¡å·²å®Œæˆçš„æ£€æŸ¥é¡¹æ•°é‡
        const completed = Object.values(checks).filter(checked => checked === true).length;
        
        // è®¡ç®—ç™¾åˆ†æ¯”
        const percentage = totalItems > 0 ? Math.round((completed / totalItems) * 100) : 0;
        
        return {
          completed,
          total: totalItems,
          percentage
        };
      }
    }
    
    // ==================== åº”ç”¨ä¸»æ§åˆ¶å™¨ ====================
    
    /**
     * ChecklistApp ç±»
     * åº”ç”¨çš„ä¸»æ§åˆ¶å™¨ï¼Œè´Ÿè´£æ¸²æŸ“æ£€æŸ¥æ¸…å•å’Œå¤„ç†ç”¨æˆ·äº¤äº’
     */
    class ChecklistApp {
      /**
       * æ„é€ å‡½æ•°
       * åˆå§‹åŒ–å­˜å‚¨ç®¡ç†å™¨å’Œ DOM å…ƒç´ å¼•ç”¨
       */
      constructor() {
        this.storageManager = new StorageManager();
        this.checklistData = checklistData;
        
        // DOM å…ƒç´ å¼•ç”¨
        this.checklistContainer = document.getElementById('checklistContainer');
        this.progressText = document.getElementById('progressText');
        this.progressPercentage = document.getElementById('progressPercentage');
        this.progressBarFill = document.getElementById('progressBarFill');
        this.progressBar = document.querySelector('[role="progressbar"]');
        
        // è®¡ç®—æ€»æ£€æŸ¥é¡¹æ•°é‡
        this.totalItems = this.calculateTotalItems();
        
        // å½“å‰æ˜¾ç¤ºçš„æ£€æŸ¥é¡¹ç´¢å¼•
        this.currentItemIndex = 0;
        
        // æ‰å¹³åŒ–çš„æ£€æŸ¥é¡¹åˆ—è¡¨ï¼ˆç”¨äºå•é¡¹å¯¼èˆªï¼‰
        this.flattenedItems = this.flattenChecklistItems();
      }
      
      /**
       * è®¡ç®—æ€»æ£€æŸ¥é¡¹æ•°é‡
       * @returns {number} æ€»æ•°é‡
       */
      calculateTotalItems() {
        return this.checklistData.categories.reduce((total, category) => {
          return total + category.items.length;
        }, 0);
      }
      
      /**
       * æ‰å¹³åŒ–æ£€æŸ¥é¡¹åˆ—è¡¨
       * å°†æ‰€æœ‰åˆ†ç±»çš„æ£€æŸ¥é¡¹åˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¾¿äºå•é¡¹å¯¼èˆª
       * @returns {Array} æ‰å¹³åŒ–çš„æ£€æŸ¥é¡¹æ•°ç»„
       */
      flattenChecklistItems() {
        const flattened = [];
        this.checklistData.categories.forEach(category => {
          category.items.forEach(item => {
            flattened.push({
              ...item,
              categoryId: category.id,
              categoryTitle: category.title
            });
          });
        });
        return flattened;
      }
      
      /**
       * åˆå§‹åŒ–åº”ç”¨
       * æ¸²æŸ“æ£€æŸ¥æ¸…å•å¹¶æ›´æ–°è¿›åº¦
       */
      init() {
        try {
          // æ£€æµ‹ localStorage æ˜¯å¦å¯ç”¨
          if (!this.storageManager.isAvailable) {
            this.showWarning('âš ï¸ æµè§ˆå™¨å­˜å‚¨ä¸å¯ç”¨ï¼Œæ•°æ®å°†ä¸ä¼šè¢«ä¿å­˜ã€‚åº”ç”¨ä»å¯æ­£å¸¸ä½¿ç”¨ï¼Œä½†åˆ·æ–°é¡µé¢åæ•°æ®ä¼šä¸¢å¤±ã€‚');
          }
          
          // æ£€æµ‹å¹¶æ¢å¤æŸåçš„æ•°æ®
          this.validateAndRecoverData();
          
          // æ¸²æŸ“æ£€æŸ¥æ¸…å•
          this.renderChecklist();
          
          // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
          this.setupEventListeners();
          
          // æ›´æ–°è¿›åº¦æ˜¾ç¤º
          this.updateProgress();
          
          console.log('åº”ç”¨åˆå§‹åŒ–å®Œæˆ');
        } catch (e) {
          console.error('åº”ç”¨åˆå§‹åŒ–å¤±è´¥:', e);
          this.showError('åº”ç”¨åˆå§‹åŒ–å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚é”™è¯¯ä¿¡æ¯: ' + e.message);
          
          // å³ä½¿åˆå§‹åŒ–å¤±è´¥ï¼Œä¹Ÿå°è¯•æ¸²æŸ“åŸºæœ¬ç•Œé¢
          try {
            this.renderChecklist();
            this.setupEventListeners();
          } catch (fallbackError) {
            console.error('å¤‡ç”¨åˆå§‹åŒ–ä¹Ÿå¤±è´¥:', fallbackError);
          }
        }
      }
      
      /**
       * éªŒè¯å¹¶æ¢å¤æŸåçš„æ•°æ®
       * æ£€æµ‹ localStorage ä¸­çš„æ•°æ®æ˜¯å¦æœ‰æ•ˆï¼Œå¦‚æœæŸååˆ™æ¸…é™¤å¹¶é‡ç½®
       */
      validateAndRecoverData() {
        if (!this.storageManager.isAvailable) {
          return;
        }
        
        try {
          const data = this.storageManager.getAllStates();
          
          // éªŒè¯æ•°æ®ç»“æ„çš„å®Œæ•´æ€§
          if (typeof data !== 'object' || data === null) {
            throw new Error('æ•°æ®ç»“æ„æ— æ•ˆ');
          }
          
          if (typeof data.checks !== 'object' || typeof data.notes !== 'object') {
            throw new Error('æ•°æ®å­—æ®µç¼ºå¤±æˆ–ç±»å‹é”™è¯¯');
          }
          
          // éªŒè¯ checks ä¸­çš„å€¼éƒ½æ˜¯å¸ƒå°”ç±»å‹
          for (const [key, value] of Object.entries(data.checks)) {
            if (typeof value !== 'boolean') {
              console.warn(`æ£€æŸ¥é¡¹ ${key} çš„å€¼ç±»å‹æ— æ•ˆï¼Œå·²å¿½ç•¥`);
              delete data.checks[key];
            }
          }
          
          // éªŒè¯ notes ä¸­çš„å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ç±»å‹
          for (const [key, value] of Object.entries(data.notes)) {
            if (typeof value !== 'string') {
              console.warn(`å¤‡æ³¨ ${key} çš„å€¼ç±»å‹æ— æ•ˆï¼Œå·²å¿½ç•¥`);
              delete data.notes[key];
            }
          }
          
          console.log('æ•°æ®éªŒè¯é€šè¿‡');
        } catch (e) {
          console.error('æ£€æµ‹åˆ°æ•°æ®æŸå:', e);
          
          // æ•°æ®æŸåï¼Œæ¸…é™¤å¹¶é‡ç½®
          this.storageManager.resetAll();
          this.showWarning('âš ï¸ æ£€æµ‹åˆ°æ•°æ®æŸåï¼Œå·²è‡ªåŠ¨é‡ç½®ã€‚è¯·é‡æ–°å¼€å§‹æ£€æŸ¥ã€‚');
        }
      }
      
      /**
       * æ˜¾ç¤ºè­¦å‘Šä¿¡æ¯
       * @param {string} message - è­¦å‘Šæ¶ˆæ¯
       */
      showWarning(message) {
        console.warn(message);
        this.showNotification(message, 'warning');
      }
      
      /**
       * æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
       * @param {string} message - é”™è¯¯æ¶ˆæ¯
       */
      showError(message) {
        console.error(message);
        this.showNotification(message, 'error');
      }
      
      /**
       * æ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯
       * @param {string} message - æ¶ˆæ¯å†…å®¹
       * @param {string} type - æ¶ˆæ¯ç±»å‹ ('warning' æˆ– 'error')
       */
      showNotification(message, type = 'warning') {
        // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨é€šçŸ¥ï¼Œé¿å…é‡å¤æ˜¾ç¤º
        const existingNotification = document.querySelector('.notification-message');
        if (existingNotification) {
          existingNotification.remove();
        }
        
        const notificationDiv = document.createElement('div');
        notificationDiv.className = 'notification-message';
        notificationDiv.setAttribute('role', 'alert');
        notificationDiv.setAttribute('aria-live', 'polite');
        
        // æ ¹æ®ç±»å‹è®¾ç½®ä¸åŒçš„æ ·å¼
        if (type === 'error') {
          notificationDiv.style.cssText = 'background-color: #fee2e2; color: #991b1b; padding: 1rem; margin-bottom: 1rem; border-radius: 0.5rem; text-align: center; border-left: 4px solid #dc2626;';
        } else {
          notificationDiv.style.cssText = 'background-color: #fef3c7; color: #92400e; padding: 1rem; margin-bottom: 1rem; border-radius: 0.5rem; text-align: center; border-left: 4px solid #f59e0b;';
        }
        
        notificationDiv.textContent = message;
        
        // æ’å…¥åˆ°æ£€æŸ¥æ¸…å•å®¹å™¨ä¹‹å‰
        const container = this.checklistContainer.parentElement;
        const header = container.querySelector('.header');
        if (header && header.nextSibling) {
          container.insertBefore(notificationDiv, header.nextSibling);
        } else {
          container.insertBefore(notificationDiv, this.checklistContainer);
        }
        
        // 5ç§’åè‡ªåŠ¨ç§»é™¤è­¦å‘Šæ¶ˆæ¯ï¼ˆé”™è¯¯æ¶ˆæ¯ä¸è‡ªåŠ¨ç§»é™¤ï¼‰
        if (type === 'warning') {
          setTimeout(() => {
            if (notificationDiv.parentElement) {
              notificationDiv.remove();
            }
          }, 5000);
        }
      }
      
      /**
       * æ¸²æŸ“å®Œæ•´çš„æ£€æŸ¥æ¸…å•
       * ä½¿ç”¨å•é¡¹å¡ç‰‡è§†å›¾
       */
      renderChecklist() {
        // æ¸…ç©ºå®¹å™¨
        this.checklistContainer.innerHTML = '';
        
        // æ¸²æŸ“æ‰€æœ‰æ£€æŸ¥é¡¹ä¸ºå•ç‹¬çš„å¡ç‰‡
        this.flattenedItems.forEach((item, index) => {
          const cardElement = this.renderSingleItemCard(item, index);
          this.checklistContainer.appendChild(cardElement);
        });
        
        // æ™ºèƒ½å®šä½ï¼šæ˜¾ç¤ºç¬¬ä¸€ä¸ªæœªå®Œæˆçš„é¡¹ç›®ï¼Œå¦‚æœéƒ½å®Œæˆäº†åˆ™æ˜¾ç¤ºæœ€åä¸€é¡¹
        const nextIncompleteIndex = this.findNextIncompleteItem(0);
        if (nextIncompleteIndex !== null) {
          // æœ‰æœªå®Œæˆçš„é¡¹ç›®ï¼Œè·³è½¬åˆ°ç¬¬ä¸€ä¸ªæœªå®Œæˆçš„
          this.currentItemIndex = nextIncompleteIndex;
        } else {
          // å…¨éƒ¨å®Œæˆï¼Œè·³è½¬åˆ°æœ€åä¸€é¡¹
          this.currentItemIndex = this.flattenedItems.length - 1;
        }
        this.showCurrentItem();
      }
      
      /**
       * æŸ¥æ‰¾ä¸‹ä¸€ä¸ªæœªå®Œæˆçš„æ£€æŸ¥é¡¹
       * @param {number} startIndex - å¼€å§‹æŸ¥æ‰¾çš„ç´¢å¼•
       * @returns {number|null} æœªå®Œæˆé¡¹çš„ç´¢å¼•ï¼Œå¦‚æœéƒ½å®Œæˆäº†è¿”å› null
       */
      findNextIncompleteItem(startIndex) {
        for (let i = startIndex; i < this.flattenedItems.length; i++) {
          const item = this.flattenedItems[i];
          if (!this.storageManager.getCheckState(item.id)) {
            return i;
          }
        }
        return null;
      }
      
      /**
       * æ¸²æŸ“å•ä¸ªæ£€æŸ¥é¡¹å¡ç‰‡
       * @param {Object} item - æ£€æŸ¥é¡¹å¯¹è±¡ï¼ˆåŒ…å« categoryTitleï¼‰
       * @param {number} index - åœ¨æ‰å¹³åŒ–åˆ—è¡¨ä¸­çš„ç´¢å¼•
       * @returns {HTMLElement} å¡ç‰‡çš„ DOM å…ƒç´ 
       */
      renderSingleItemCard(item, index) {
        const isChecked = this.storageManager.getCheckState(item.id);
        const noteText = this.storageManager.getNote(item.id);
        
        const card = document.createElement('div');
        card.className = 'single-item-card';
        card.dataset.itemId = item.id;
        card.dataset.itemIndex = index;
        
        // ç”Ÿæˆæç¤ºæ–‡æœ¬
        const hint = this.generateHintForItem(item);
        
        card.innerHTML = `
          <div class="category-badge">${item.categoryTitle}</div>
          <div class="item-content">
            <div class="item-text">${item.text}</div>
            ${hint ? `<div class="item-hint">${hint}</div>` : ''}
          </div>
          
          <div class="checkbox-section">
            <input type="checkbox" id="check_${item.id}" ${isChecked ? 'checked' : ''} 
                   aria-label="${item.text}" data-item-id="${item.id}">
            <label for="check_${item.id}" class="checkbox-label ${isChecked ? 'completed' : ''}">
              ${isChecked ? 'âœ“ å·²å®Œæˆ' : 'æ ‡è®°ä¸ºå®Œæˆ'}
            </label>
          </div>
          
          <textarea class="note-input" placeholder="æ·»åŠ å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰..." 
                    data-item-id="${item.id}" 
                    aria-label="${item.text} çš„å¤‡æ³¨">${noteText}</textarea>
          
          <div class="navigation-buttons">
            <button class="nav-btn nav-btn-prev" data-action="prev" ${index === 0 ? 'disabled' : ''}>
              â† ä¸Šä¸€é¡¹
            </button>
            <button class="nav-btn nav-btn-next" data-action="${index === this.flattenedItems.length - 1 ? 'complete' : 'next'}">
              ${index === this.flattenedItems.length - 1 ? 'ğŸ‰ å®Œæˆæ£€æŸ¥' : 'ä¸‹ä¸€é¡¹ â†’'}
            </button>
          </div>
          
          <div class="item-progress">
            ç¬¬ ${index + 1} é¡¹ï¼Œå…± ${this.flattenedItems.length} é¡¹
          </div>
        `;
        
        return card;
      }
      
      /**
       * ä¸ºæ£€æŸ¥é¡¹ç”Ÿæˆæç¤ºæ–‡æœ¬
       * @param {Object} item - æ£€æŸ¥é¡¹å¯¹è±¡
       * @returns {string} æç¤ºæ–‡æœ¬
       */
      generateHintForItem(item) {
        const hints = {
          // è¯ä»¶æ£€æŸ¥
          'doc_1': 'æ ¸å¯¹è½¦è¾†åˆæ ¼è¯åŸä»¶ä¿¡æ¯å®Œæ•´æ¸…æ™°ï¼Œæ£€æŸ¥è½¦æ¶å·ï¼ˆVINç ï¼‰åœ¨å‰æŒ¡é£ç»ç’ƒå·¦ä¸‹è§’æˆ–BæŸ±ï¼Œç¡®ä¿ä¸åˆæ ¼è¯ä¸€è‡´',
          'doc_2': 'æ£€æŸ¥PDIï¼ˆPre-Delivery Inspectionï¼‰äº¤è½¦å‰æ£€æµ‹æŠ¥å‘Šï¼Œç¡®è®¤æ‰€æœ‰æ£€æµ‹é¡¹ç›®åˆæ ¼ï¼Œæ— é—ç•™é—®é¢˜',
          'doc_3': 'ç¡®è®¤ä¿å…»æ‰‹å†Œå’Œä½¿ç”¨è¯´æ˜ä¹¦é½å…¨å®Œæ•´ï¼Œäº†è§£ä¿å…»å‘¨æœŸå’Œæ³¨æ„äº‹é¡¹',
          'doc_4': 'æ ¸å¯¹è½¦è¾†é“­ç‰Œä¿¡æ¯ï¼ˆé€šå¸¸åœ¨BæŸ±æˆ–å‘åŠ¨æœºèˆ±ï¼‰ï¼Œç¡®è®¤ç”Ÿäº§æ—¥æœŸã€è½¦å‹ã€é…ç½®ç­‰ä¿¡æ¯ä¸åˆæ ¼è¯ä¸€è‡´',
          
          // å¤–è§‚æ£€æŸ¥
          'ext_1': 'åœ¨è‡ªç„¶å…‰ä¸‹ä»”ç»†æ£€æŸ¥è½¦èº«å„ä¸ªè§’åº¦ï¼Œç‰¹åˆ«æ³¨æ„å…‰çº¿åå°„å¤„ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰ç»†å¾®åˆ’ç—•ã€å‡¹é™·æˆ–è‰²å·®',
          'ext_2': 'é€ä¸ªå¼€å…³æ‰€æœ‰è½¦é—¨ï¼ˆåŒ…æ‹¬å‰åé—¨ï¼‰ï¼Œæ£€æŸ¥å¼€å…³æ˜¯å¦é¡ºç•…ï¼Œå¯†å°æ¡æ˜¯å¦å®Œæ•´æ— ç ´æŸï¼Œå…³é—¨æ—¶å£°éŸ³æ˜¯å¦æ¸…è„†',
          'ext_3': 'æ£€æŸ¥å‰åä¿é™©æ æ˜¯å¦æœ‰è£‚çº¹ã€å˜å½¢ã€æ¾åŠ¨æˆ–åˆ’ç—•ï¼Œç¡®è®¤å®‰è£…ç‰¢å›º',
          'ext_4': 'æ‰“å¼€æ‰€æœ‰ç¯å…‰æµ‹è¯•ï¼šè¿œè¿‘å…‰ç¯ã€é›¾ç¯ã€è½¬å‘ç¯ã€åˆ¹è½¦ç¯ã€æ—¥é—´è¡Œè½¦ç¯ï¼Œç¡®è®¤éƒ½èƒ½æ­£å¸¸å·¥ä½œä¸”äº®åº¦å‡åŒ€',
          'ext_5': 'æ£€æŸ¥å¤–åè§†é•œé•œé¢æ˜¯å¦å®Œå¥½æ— åˆ’ç—•ï¼Œæµ‹è¯•ç”µåŠ¨è°ƒèŠ‚ã€æŠ˜å åŠŸèƒ½ï¼Œç¡®è®¤åŠ çƒ­é™¤é›¾åŠŸèƒ½æ­£å¸¸',
          'ext_6': 'æ£€æŸ¥å››ä¸ªè½®èƒç”Ÿäº§æ—¥æœŸã€èƒçº¹ç£¨æŸï¼Œè¡¨é¢æ— é¼“åŒ…ã€è£‚çº¹ã€å¼‚ç‰©ç­‰',
          'ext_7': 'æ£€æŸ¥å››ä¸ªè½®æ¯‚æ˜¯å¦æœ‰åˆ’ç—•ã€å˜å½¢ã€è…èš€æˆ–ç¼ºæŸï¼Œç¡®è®¤è½®æ¯‚ç›–å®‰è£…ç‰¢å›º',
          'ext_8': 'æ£€æŸ¥å…¨è½¦ç»ç’ƒï¼ˆå‰åæŒ¡é£ç»ç’ƒã€ä¾§çª—ï¼‰ç”Ÿäº§æ—¥æœŸã€æ˜¯å¦æœ‰è£‚çº¹ã€åˆ’ç—•æˆ–æ°”æ³¡ï¼Œç¡®è®¤ç»ç’ƒæ ‡è¯†å®Œæ•´',
          'ext_9': 'æµ‹è¯•å‰åé›¨åˆ·å™¨å„æ¡£ä½åŠŸèƒ½ï¼Œæ£€æŸ¥é›¨åˆ·æ¡æ˜¯å¦å®Œå¥½ï¼Œåˆ®æ°´æ˜¯å¦å¹²å‡€æ— å¼‚å“',
          'ext_10': 'æ‰“å¼€å‰å¤‡ç®±ï¼Œæ£€æŸ¥å†…éƒ¨æ˜¯å¦æ•´æ´ï¼Œå‚¨ç‰©ç©ºé—´æ˜¯å¦å®Œå¥½ï¼Œå¼€å…³æ˜¯å¦é¡ºç•…',
          'ext_11': 'æ‰“å¼€åå¤‡ç®±ï¼Œæ£€æŸ¥å†…éƒ¨æ˜¯å¦æ•´æ´ï¼Œåœ°æ¿æ˜¯å¦å¹³æ•´ï¼Œå¼€å…³ã€ç…§æ˜ç¯æ˜¯å¦æ­£å¸¸',
          
          // å†…é¥°æ£€æŸ¥
          'int_1': 'ä»”ç»†æ£€æŸ¥åº§æ¤…é¢æ–™æ˜¯å¦æœ‰æ±¡æ¸ã€ç ´æŸã€çº¿å¤´ã€è‰²å·®æˆ–è¤¶çš±ï¼Œç¡®è®¤ç¼çº¿æ•´é½ï¼Œæè´¨å‡åŒ€',
          'int_2': 'æ£€æŸ¥æ–¹å‘ç›˜ã€æ¡£æŠŠè¡¨é¢æ˜¯å¦å…‰æ»‘æ— ç£¨æŸã€æ— åˆ’ç—•ï¼ˆæ–°è½¦åº”è¯¥å¾ˆæ–°ï¼‰ï¼Œæ¡æ„Ÿæ˜¯å¦èˆ’é€‚',
          'int_3': 'å¯åŠ¨è½¦è¾†ï¼Œè§‚å¯Ÿä»ªè¡¨ç›˜æ˜¾ç¤ºæ˜¯å¦æ­£å¸¸ï¼Œç¡®è®¤æ— æ•…éšœç¯äº®èµ·ï¼ˆé™¤æ­£å¸¸è‡ªæ£€å¤–ï¼‰ï¼Œæ£€æŸ¥å„é¡¹ä¿¡æ¯æ˜¾ç¤ºå‡†ç¡®',
          'int_4': 'æµ‹è¯•å‰æ’åŒè”å±ã€åæ’å¨±ä¹å±ã€æ–¹å‘ç›˜å°å±ã€åæ’ç©ºè°ƒå°å±çš„è§¦æ‘¸å“åº”ã€æ˜¾ç¤ºæ•ˆæœã€åŠŸèƒ½åˆ‡æ¢æ˜¯å¦æ­£å¸¸',
          'int_5': 'æ‰“å¼€ç©ºè°ƒï¼Œæµ‹è¯•åˆ¶å†·å’Œåˆ¶çƒ­åŠŸèƒ½ï¼Œæ£€æŸ¥å„å‡ºé£å£é£é‡æ˜¯å¦å‡åŒ€ï¼Œæ¸©åº¦è°ƒèŠ‚æ˜¯å¦çµæ•',
          'int_6': 'æµ‹è¯•å†°ç®±åˆ¶å†·å’Œåˆ¶çƒ­åŠŸèƒ½ï¼Œæ£€æŸ¥æ¸©åº¦è°ƒèŠ‚æ˜¯å¦æ­£å¸¸ï¼Œåˆ¶å†·æ•ˆæœæ˜¯å¦æ˜æ˜¾',
          'int_7': 'æµ‹è¯•æ‰€æœ‰è½¦çª—ï¼ˆå‰åå·¦å³ï¼‰çš„å‡é™åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä¸€é”®å‡é™ã€é˜²å¤¹åŠŸèƒ½æ˜¯å¦æ­£å¸¸',
          'int_8': 'æµ‹è¯•åæ’é®é˜³å¸˜æ‰‹åŠ¨å‡é™åŠŸèƒ½ï¼Œæ£€æŸ¥æœ‰æ— å¡é¡¿',
          'int_9': 'æµ‹è¯•æ— çº¿å……ç”µåŠŸèƒ½ï¼Œæ”¾ç½®æ‰‹æœºæ£€æŸ¥æ˜¯å¦èƒ½æ­£å¸¸å……ç”µ',
          'int_10': 'æµ‹è¯•åæ’æœ‰çº¿å……ç”µæ¥å£ï¼ˆType-Cï¼‰ï¼Œè¿æ¥è®¾å¤‡æ£€æŸ¥æ˜¯å¦èƒ½æ­£å¸¸å……ç”µå’ŒæŠ•å±',
          'int_11': 'æµ‹è¯•å‰æ’åº§æ¤…çš„å‰åã€é«˜ä½ã€é èƒŒè°ƒèŠ‚åŠŸèƒ½ï¼Œä»¥åŠé€šé£ã€åŠ çƒ­ã€æŒ‰æ‘©åŠŸèƒ½æ˜¯å¦æ­£å¸¸',
          'int_12': 'æµ‹è¯•åæ’åº§æ¤…çš„è°ƒèŠ‚åŠŸèƒ½ã€çš‡ååæ¤…ï¼Œä»¥åŠé€šé£ã€åŠ çƒ­åŠŸèƒ½æ˜¯å¦æ­£å¸¸',
          'int_13': 'æµ‹è¯•HUDï¼ˆæŠ¬å¤´æ˜¾ç¤ºï¼‰çš„å¼€å…³ã€äº®åº¦ã€é«˜åº¦è°ƒèŠ‚åŠŸèƒ½ï¼Œæ£€æŸ¥æ˜¾ç¤ºå†…å®¹æ˜¯å¦æ¸…æ™°',
          'int_14': 'æ’­æ”¾éŸ³ä¹æµ‹è¯•éŸ³å“ç³»ç»Ÿï¼Œè°ƒèŠ‚éŸ³é‡ã€éŸ³æ•ˆï¼Œæ£€æŸ¥å„ä¸ªæ‰¬å£°å™¨æ˜¯å¦æ­£å¸¸å·¥ä½œï¼ŒéŸ³è´¨æ˜¯å¦æ¸…æ™°',
          'int_15': 'æµ‹è¯•å¤©çª—é®é˜³å¸˜å¼€å…³ï¼Œæ£€æŸ¥å¼€å…³æ˜¯å¦é¡ºç•…ï¼Œç»ç’ƒæ˜¯å¦å®Œå¥½',
          'int_16': 'æµ‹è¯•è½¦å†…å„å¤„ç¯å…‰ï¼šé˜…è¯»ç¯ã€æ°›å›´ç¯ã€åå¤‡ç®±ç¯ç­‰ï¼Œæ£€æŸ¥äº®åº¦è°ƒèŠ‚å’Œå¼€å…³æ˜¯å¦æ­£å¸¸',
          
          // æœºæ¢°æ£€æŸ¥
          'mech_1': 'æµ‹è¯•æ–¹å‘ç›˜çš„ä¸Šä¸‹ã€å‰åè°ƒèŠ‚åŠŸèƒ½ï¼Œæ£€æŸ¥è°ƒèŠ‚æ˜¯å¦é¡ºç•…ï¼Œé”æ­¢æ˜¯å¦ç‰¢å›º',
          
          // é…ä»¶æ£€æŸ¥
          'acc_1': 'ç¡®è®¤æ‹†è½®èƒå·¥å…·ï¼ˆæ‰³æ‰‹ã€æ‹–è½¦é’©ç­‰ï¼‰é½å…¨ä¸”å®Œå¥½',
          'acc_2': 'ç¡®è®¤ä¸‰è§’è­¦ç¤ºç‰Œåœ¨è½¦å†…ï¼Œæ£€æŸ¥æ˜¯å¦å®Œå¥½æ— æŸï¼Œèƒ½å¦æ­£å¸¸å±•å¼€',
          'acc_3': 'æ£€æŸ¥éšè½¦å·¥å…·åŒ…æ˜¯å¦é½å…¨ï¼ŒåŒ…æ‹¬è¯´æ˜ä¹¦ã€ä¿ä¿®å¡ã€é’¥åŒ™ç­‰ç‰©å“',
          'acc_4': 'ç¡®è®¤è‡³å°‘æœ‰2æŠŠå¡ç‰‡é’¥åŒ™ï¼ˆå«å¤‡ç”¨é’¥åŒ™ï¼‰ï¼Œæµ‹è¯•æ‰€æœ‰é’¥åŒ™çš„è§£é”ã€ä¸Šé”ã€å¯åŠ¨ç­‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸',
          'acc_5': 'æµ‹è¯•å……ç”µåŠŸèƒ½ï¼ˆæ–°èƒ½æºè½¦ï¼‰ï¼Œè¿æ¥å……ç”µæªæ£€æŸ¥æ˜¯å¦èƒ½æ­£å¸¸å……ç”µï¼Œå……ç”µæŒ‡ç¤ºç¯å’Œè½¦å†…æ˜¾ç¤ºæ˜¯å¦æ­£å¸¸',
          
          // æœ€ç»ˆç¡®è®¤
          'fin_1': 'æœ€åå…¨é¢æ£€æŸ¥ï¼Œç¡®è®¤æ‰€æœ‰æ£€æŸ¥é¡¹éƒ½æ²¡æœ‰é‡å¤§é—®é¢˜ï¼Œè¯ä»¶é½å…¨ï¼Œå¯ä»¥æ”¾å¿ƒæè½¦å¹¶åŠç†åç»­æ‰‹ç»­'
        };
        
        return hints[item.id] || '';
      }
      
      /**
       * æ˜¾ç¤ºå½“å‰æ£€æŸ¥é¡¹
       */
      showCurrentItem() {
        // éšè—æ‰€æœ‰å¡ç‰‡
        const allCards = this.checklistContainer.querySelectorAll('.single-item-card');
        allCards.forEach(card => card.classList.remove('active'));
        
        // æ˜¾ç¤ºå½“å‰å¡ç‰‡
        const currentCard = this.checklistContainer.querySelector(`[data-item-index="${this.currentItemIndex}"]`);
        if (currentCard) {
          currentCard.classList.add('active');
          
          // æ»šåŠ¨åˆ°é¡¶éƒ¨
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }
      }
      
      /**
       * å¯¼èˆªåˆ°ä¸Šä¸€é¡¹
       */
      navigateToPrevious() {
        if (this.currentItemIndex > 0) {
          this.currentItemIndex--;
          this.showCurrentItem();
        }
      }
      
      /**
       * å¯¼èˆªåˆ°ä¸‹ä¸€é¡¹
       */
      navigateToNext() {
        if (this.currentItemIndex < this.flattenedItems.length - 1) {
          this.currentItemIndex++;
          this.showCurrentItem();
        }
      }
      
      /**
       * æ¸²æŸ“å•ä¸ªåˆ†ç±»
       * @param {Object} category - åˆ†ç±»å¯¹è±¡
       * @returns {HTMLElement} åˆ†ç±»çš„ DOM å…ƒç´ 
       */
      renderCategory(category) {
        // åˆ›å»ºåˆ†ç±»å¡ç‰‡å®¹å™¨
        const categoryCard = document.createElement('section');
        categoryCard.className = 'category-card';
        categoryCard.dataset.categoryId = category.id;
        categoryCard.setAttribute('aria-labelledby', `category-title-${category.id}`);
        
        // è®¡ç®—è¯¥åˆ†ç±»çš„å®Œæˆè¿›åº¦
        const categoryProgress = this.calculateCategoryProgress(category);
        
        // åˆ›å»ºåˆ†ç±»å¤´éƒ¨
        const categoryHeader = document.createElement('header');
        categoryHeader.className = 'category-header';
        categoryHeader.innerHTML = `
          <span class="category-title" id="category-title-${category.id}">${category.title}</span>
          <span class="category-progress" aria-label="${category.title}å®Œæˆè¿›åº¦">${categoryProgress.completed} / ${categoryProgress.total}</span>
        `;
        
        // åˆ›å»ºæ£€æŸ¥é¡¹å®¹å™¨
        const categoryItems = document.createElement('div');
        categoryItems.className = 'category-items';
        categoryItems.setAttribute('role', 'list');
        
        // æ¸²æŸ“è¯¥åˆ†ç±»ä¸‹çš„æ‰€æœ‰æ£€æŸ¥é¡¹
        category.items.forEach(item => {
          const itemElement = this.renderCheckItem(item, category.id);
          categoryItems.appendChild(itemElement);
        });
        
        // ç»„è£…åˆ†ç±»å¡ç‰‡
        categoryCard.appendChild(categoryHeader);
        categoryCard.appendChild(categoryItems);
        
        return categoryCard;
      }
      
      /**
       * è®¡ç®—å•ä¸ªåˆ†ç±»çš„å®Œæˆè¿›åº¦
       * @param {Object} category - åˆ†ç±»å¯¹è±¡
       * @returns {Object} åŒ…å« completed å’Œ total çš„å¯¹è±¡
       */
      calculateCategoryProgress(category) {
        let completed = 0;
        
        category.items.forEach(item => {
          if (this.storageManager.getCheckState(item.id)) {
            completed++;
          }
        });
        
        return {
          completed,
          total: category.items.length
        };
      }
      
      /**
       * æ¸²æŸ“å•ä¸ªæ£€æŸ¥é¡¹
       * @param {Object} item - æ£€æŸ¥é¡¹å¯¹è±¡
       * @param {string} categoryId - æ‰€å±åˆ†ç±»çš„ ID
       * @returns {HTMLElement} æ£€æŸ¥é¡¹çš„ DOM å…ƒç´ 
       */
      renderCheckItem(item, categoryId) {
        // ä» localStorage è·å–è¯¥æ£€æŸ¥é¡¹çš„çŠ¶æ€
        const isChecked = this.storageManager.getCheckState(item.id);
        const noteText = this.storageManager.getNote(item.id);
        
        // åˆ›å»ºæ£€æŸ¥é¡¹å®¹å™¨
        const checkItem = document.createElement('div');
        checkItem.className = 'check-item';
        checkItem.dataset.itemId = item.id;
        checkItem.dataset.categoryId = categoryId;
        checkItem.setAttribute('role', 'listitem');
        
        // åˆ›å»ºæ£€æŸ¥é¡¹è¡Œï¼ˆå¤é€‰æ¡† + æ ‡ç­¾ï¼‰
        const checkItemRow = document.createElement('div');
        checkItemRow.className = 'check-item-row';
        
        // åˆ›å»ºå¤é€‰æ¡†åŒ…è£…å™¨
        const checkboxWrapper = document.createElement('div');
        checkboxWrapper.className = 'checkbox-wrapper';
        
        // åˆ›å»ºå¤é€‰æ¡†
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = `check_${item.id}`;
        checkbox.checked = isChecked;
        checkbox.setAttribute('aria-label', item.text);
        checkbox.setAttribute('aria-checked', isChecked ? 'true' : 'false');
        checkbox.dataset.itemId = item.id;
        
        checkboxWrapper.appendChild(checkbox);
        
        // åˆ›å»ºæ ‡ç­¾
        const label = document.createElement('label');
        label.className = 'check-item-label';
        label.htmlFor = `check_${item.id}`;
        label.textContent = item.text;
        
        // å¦‚æœå·²å®Œæˆï¼Œæ·»åŠ å®Œæˆæ ·å¼
        if (isChecked) {
          label.classList.add('completed');
        }
        
        // ç»„è£…æ£€æŸ¥é¡¹è¡Œ
        checkItemRow.appendChild(checkboxWrapper);
        checkItemRow.appendChild(label);
        
        // åˆ›å»ºå¤‡æ³¨è¾“å…¥æ¡†
        const noteInput = document.createElement('textarea');
        noteInput.className = 'note-input';
        noteInput.placeholder = 'æ·»åŠ å¤‡æ³¨...';
        noteInput.value = noteText;
        noteInput.rows = 2;
        noteInput.dataset.itemId = item.id;
        noteInput.setAttribute('aria-label', `${item.text} çš„å¤‡æ³¨`);
        
        // ç»„è£…æ£€æŸ¥é¡¹
        checkItem.appendChild(checkItemRow);
        checkItem.appendChild(noteInput);
        
        return checkItem;
      }
      
      /**
       * æ›´æ–°è¿›åº¦æ˜¾ç¤º
       * è®¡ç®—å¹¶æ›´æ–°é¡µé¢é¡¶éƒ¨çš„è¿›åº¦ä¿¡æ¯
       */
      updateProgress() {
        const progress = this.storageManager.calculateProgress(this.totalItems);
        
        // æ›´æ–°è¿›åº¦æ–‡æœ¬
        this.progressText.textContent = `å·²å®Œæˆ ${progress.completed} / ${progress.total} é¡¹`;
        
        // æ›´æ–°ç™¾åˆ†æ¯”
        this.progressPercentage.textContent = `${progress.percentage}%`;
        
        // æ›´æ–°è¿›åº¦æ¡
        this.progressBarFill.style.width = `${progress.percentage}%`;
        
        // æ›´æ–° ARIA å±æ€§
        this.progressBar.setAttribute('aria-valuenow', progress.percentage);
      }
      
      /**
       * å¤„ç†å¤é€‰æ¡†çŠ¶æ€å˜åŒ–
       * @param {Event} event - change äº‹ä»¶å¯¹è±¡
       */
      handleCheckboxChange(event) {
        const checkbox = event.target;
        const itemId = checkbox.dataset.itemId;
        const isChecked = checkbox.checked;
        
        // æ›´æ–° aria-checked å±æ€§
        checkbox.setAttribute('aria-checked', isChecked ? 'true' : 'false');
        
        // ä¿å­˜çŠ¶æ€åˆ° localStorage
        this.storageManager.saveCheckState(itemId, isChecked);
        
        // æ›´æ–° UI æ˜¾ç¤º - åœ¨å•é¡¹å¡ç‰‡è§†å›¾ä¸­æ›´æ–°æ ‡ç­¾
        const card = checkbox.closest('.single-item-card');
        if (card) {
          const label = card.querySelector('.checkbox-label');
          if (label) {
            if (isChecked) {
              label.classList.add('completed');
              label.textContent = 'âœ“ å·²å®Œæˆ';
            } else {
              label.classList.remove('completed');
              label.textContent = 'æ ‡è®°ä¸ºå®Œæˆ';
            }
          }
        } else {
          // æ—§ç‰ˆå…¨åˆ—è¡¨è§†å›¾çš„å¤„ç†ï¼ˆä¿ç•™å…¼å®¹æ€§ï¼‰
          const label = checkbox.closest('.check-item-row')?.querySelector('.check-item-label');
          if (label) {
            if (isChecked) {
              label.classList.add('completed');
            } else {
              label.classList.remove('completed');
            }
          }
          
          // æ›´æ–°åˆ†ç±»è¿›åº¦æ˜¾ç¤º
          const checkItem = checkbox.closest('.check-item');
          if (checkItem) {
            const categoryId = checkItem.dataset.categoryId;
            this.updateCategoryProgress(categoryId);
          }
        }
        
        // è§¦å‘æ•´ä½“è¿›åº¦æ›´æ–°
        this.updateProgress();
      }
      
      /**
       * æ›´æ–°å•ä¸ªåˆ†ç±»çš„è¿›åº¦æ˜¾ç¤º
       * @param {string} categoryId - åˆ†ç±» ID
       */
      updateCategoryProgress(categoryId) {
        // æ‰¾åˆ°å¯¹åº”çš„åˆ†ç±»å¡ç‰‡
        const categoryCard = document.querySelector(`[data-category-id="${categoryId}"]`);
        if (!categoryCard) return;
        
        // æ‰¾åˆ°è¯¥åˆ†ç±»çš„æ•°æ®
        const category = this.checklistData.categories.find(cat => cat.id === categoryId);
        if (!category) return;
        
        // è®¡ç®—è¯¥åˆ†ç±»çš„å®Œæˆè¿›åº¦
        const categoryProgress = this.calculateCategoryProgress(category);
        
        // æ›´æ–°åˆ†ç±»å¤´éƒ¨çš„è¿›åº¦æ˜¾ç¤º
        const progressSpan = categoryCard.querySelector('.category-progress');
        if (progressSpan) {
          progressSpan.textContent = `${categoryProgress.completed} / ${categoryProgress.total}`;
        }
      }
      
      /**
       * é˜²æŠ–å‡½æ•°
       * å»¶è¿Ÿæ‰§è¡Œå‡½æ•°ï¼Œé¿å…é¢‘ç¹è°ƒç”¨
       * @param {Function} func - è¦æ‰§è¡Œçš„å‡½æ•°
       * @param {number} wait - å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
       * @returns {Function} é˜²æŠ–åçš„å‡½æ•°
       */
      debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func.apply(this, args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }
      
      /**
       * å¤„ç†å¤‡æ³¨è¾“å…¥
       * @param {Event} event - input äº‹ä»¶å¯¹è±¡
       */
      handleNoteInput(event) {
        const textarea = event.target;
        const itemId = textarea.dataset.itemId;
        const noteText = textarea.value;
        
        // ä¿å­˜å¤‡æ³¨åˆ° localStorage
        this.storageManager.saveNote(itemId, noteText);
      }
      
      /**
       * å¤„ç†é‡ç½®æ“ä½œ
       * æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†ï¼Œç”¨æˆ·ç¡®è®¤åæ¸…é™¤æ‰€æœ‰æ•°æ®å¹¶é‡æ–°æ¸²æŸ“
       */
      handleReset() {
        this.showConfirmDialog(
          'ç¡®å®šè¦é‡ç½®æ£€æŸ¥æ¸…å•å—ï¼Ÿ',
          'æ­¤æ“ä½œå°†æ¸…é™¤æ‰€æœ‰å·²å®Œæˆçš„æ£€æŸ¥é¡¹å’Œå¤‡æ³¨å†…å®¹ï¼Œä¸”æ— æ³•æ¢å¤ã€‚',
          () => {
            // ç”¨æˆ·ç¡®è®¤é‡ç½®
            this.storageManager.resetAll();
            
            // é‡æ–°æ¸²æŸ“æ£€æŸ¥æ¸…å•
            this.renderChecklist();
            
            // æ›´æ–°è¿›åº¦æ˜¾ç¤º
            this.updateProgress();
            
            console.log('æ£€æŸ¥æ¸…å•å·²é‡ç½®');
          }
        );
      }
      
      /**
       * æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
       * @param {string} title - å¯¹è¯æ¡†æ ‡é¢˜
       * @param {string} message - å¯¹è¯æ¡†æ¶ˆæ¯
       * @param {Function} onConfirm - ç”¨æˆ·ç¡®è®¤æ—¶çš„å›è°ƒå‡½æ•°
       */
      showConfirmDialog(title, message, onConfirm) {
        const dialogOverlay = document.getElementById('dialogOverlay');
        const dialogTitle = document.getElementById('dialogTitle');
        const dialogMessage = document.getElementById('dialogMessage');
        const dialogConfirm = document.getElementById('dialogConfirm');
        const dialogCancel = document.getElementById('dialogCancel');
        
        // è®¾ç½®å¯¹è¯æ¡†å†…å®¹
        dialogTitle.textContent = title;
        dialogMessage.textContent = message;
        
        // æ˜¾ç¤ºå¯¹è¯æ¡†
        dialogOverlay.classList.add('active');
        
        // ç¡®è®¤æŒ‰é’®ç‚¹å‡»å¤„ç†
        const handleConfirm = () => {
          // æ‰§è¡Œç¡®è®¤å›è°ƒ
          if (typeof onConfirm === 'function') {
            onConfirm();
          }
          
          // å…³é—­å¯¹è¯æ¡†
          closeDialog();
        };
        
        // å–æ¶ˆæŒ‰é’®ç‚¹å‡»å¤„ç†
        const handleCancel = () => {
          // å…³é—­å¯¹è¯æ¡†ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œ
          closeDialog();
        };
        
        // å…³é—­å¯¹è¯æ¡†çš„å‡½æ•°
        const closeDialog = () => {
          dialogOverlay.classList.remove('active');
          
          // ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
          dialogConfirm.removeEventListener('click', handleConfirm);
          dialogCancel.removeEventListener('click', handleCancel);
          dialogOverlay.removeEventListener('click', handleOverlayClick);
          document.removeEventListener('keydown', handleEscKey);
        };
        
        // ç‚¹å‡»é®ç½©å±‚å…³é—­å¯¹è¯æ¡†
        const handleOverlayClick = (event) => {
          if (event.target === dialogOverlay) {
            handleCancel();
          }
        };
        
        // æŒ‰ Esc é”®å…³é—­å¯¹è¯æ¡†
        const handleEscKey = (event) => {
          if (event.key === 'Escape') {
            handleCancel();
          }
        };
        
        // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        dialogConfirm.addEventListener('click', handleConfirm);
        dialogCancel.addEventListener('click', handleCancel);
        dialogOverlay.addEventListener('click', handleOverlayClick);
        document.addEventListener('keydown', handleEscKey);
        
        // èšç„¦åˆ°å–æ¶ˆæŒ‰é’®ï¼ˆæ›´å®‰å…¨çš„é»˜è®¤é€‰é¡¹ï¼‰
        dialogCancel.focus();
      }
      
      /**
       * æ˜¾ç¤ºåº†ç¥åŠ¨ç”»
       */
      showCelebration() {
        const celebrationOverlay = document.getElementById('celebrationOverlay');
        const completedCountSpan = document.getElementById('completedCount');
        const notesCountSpan = document.getElementById('notesCount');
        
        // è®¡ç®—ç»Ÿè®¡æ•°æ®
        const progress = this.storageManager.calculateProgress(this.totalItems);
        const allStates = this.storageManager.getAllStates();
        const notesCount = Object.keys(allStates.notes).length;
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        completedCountSpan.textContent = progress.completed;
        notesCountSpan.textContent = notesCount;
        
        // æ˜¾ç¤ºåº†ç¥è¦†ç›–å±‚
        celebrationOverlay.classList.add('active');
        
        // åˆ›å»ºçƒŸèŠ±æ•ˆæœ
        this.createFireworks();
        
        // æ’­æ”¾çƒŸèŠ±åŠ¨ç”»ï¼ˆæŒç»­3ç§’ï¼‰
        const fireworkInterval = setInterval(() => {
          this.createFireworks();
        }, 300);
        
        // 3ç§’ååœæ­¢çƒŸèŠ±
        setTimeout(() => {
          clearInterval(fireworkInterval);
        }, 3000);
        
        // å…³é—­æŒ‰é’®äº‹ä»¶
        const closeBtn = document.getElementById('celebrationClose');
        const handleClose = () => {
          celebrationOverlay.classList.remove('active');
          closeBtn.removeEventListener('click', handleClose);
          
          // æ¸…é™¤æ‰€æœ‰çƒŸèŠ±å…ƒç´ 
          const fireworks = celebrationOverlay.querySelectorAll('.firework');
          fireworks.forEach(fw => fw.remove());
        };
        
        closeBtn.addEventListener('click', handleClose);
      }
      
      /**
       * åˆ›å»ºçƒŸèŠ±æ•ˆæœ
       */
      createFireworks() {
        const celebrationOverlay = document.getElementById('celebrationOverlay');
        const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#6c5ce7', '#a29bfe', '#fd79a8', '#fdcb6e'];
        
        // åˆ›å»º3-5ä¸ªçƒŸèŠ±çˆ†ç‚¸ç‚¹
        const fireworkCount = Math.floor(Math.random() * 3) + 3;
        
        for (let i = 0; i < fireworkCount; i++) {
          // éšæœºä½ç½®
          const x = Math.random() * window.innerWidth;
          const y = Math.random() * window.innerHeight * 0.6; // ä¸ŠåŠéƒ¨åˆ†
          
          // æ¯ä¸ªçˆ†ç‚¸ç‚¹åˆ›å»º20-30ä¸ªç²’å­
          const particleCount = Math.floor(Math.random() * 11) + 20;
          
          for (let j = 0; j < particleCount; j++) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            
            // éšæœºé¢œè‰²
            const color = colors[Math.floor(Math.random() * colors.length)];
            firework.style.backgroundColor = color;
            firework.style.boxShadow = `0 0 10px ${color}`;
            
            // è®¾ç½®åˆå§‹ä½ç½®
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            
            // éšæœºæ–¹å‘å’Œè·ç¦»
            const angle = (Math.PI * 2 * j) / particleCount;
            const velocity = Math.random() * 100 + 50;
            const tx = Math.cos(angle) * velocity;
            const ty = Math.sin(angle) * velocity;
            
            firework.style.setProperty('--tx', tx + 'px');
            firework.style.setProperty('--ty', ty + 'px');
            
            celebrationOverlay.appendChild(firework);
            
            // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
            setTimeout(() => {
              firework.remove();
            }, 1500);
          }
        }
      }
      
      /**
       * è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
       * ä½¿ç”¨äº‹ä»¶å§”æ‰˜åœ¨å®¹å™¨ä¸Šç›‘å¬æ‰€æœ‰å¤é€‰æ¡†çš„å˜åŒ–å’Œå¤‡æ³¨è¾“å…¥
       */
      setupEventListeners() {
        // ä½¿ç”¨äº‹ä»¶å§”æ‰˜ç›‘å¬å¤é€‰æ¡† change äº‹ä»¶
        this.checklistContainer.addEventListener('change', (event) => {
          if (event.target.matches('input[type="checkbox"]')) {
            this.handleCheckboxChange(event);
          }
        });
        
        // ä½¿ç”¨äº‹ä»¶å§”æ‰˜ç›‘å¬å¤é€‰æ¡†é”®ç›˜äº‹ä»¶ï¼ˆSpace/Enterï¼‰
        this.checklistContainer.addEventListener('keydown', (event) => {
          if (event.target.matches('input[type="checkbox"]')) {
            // Space é”®å’Œ Enter é”®éƒ½å¯ä»¥åˆ‡æ¢å¤é€‰æ¡†
            if (event.key === ' ' || event.key === 'Enter') {
              // å¯¹äºå¤é€‰æ¡†ï¼ŒSpace é”®æ˜¯é»˜è®¤è¡Œä¸ºï¼Œä½†æˆ‘ä»¬ç¡®ä¿ Enter é”®ä¹Ÿèƒ½å·¥ä½œ
              if (event.key === 'Enter') {
                event.preventDefault();
                event.target.checked = !event.target.checked;
                // è§¦å‘ change äº‹ä»¶
                event.target.dispatchEvent(new Event('change', { bubbles: true }));
              }
            }
          }
        });
        
        // ä½¿ç”¨äº‹ä»¶å§”æ‰˜ç›‘å¬å¤‡æ³¨è¾“å…¥æ¡† input äº‹ä»¶
        // ä½¿ç”¨é˜²æŠ–å»¶è¿Ÿ 500ms ä¿å­˜ï¼Œé¿å…é¢‘ç¹å†™å…¥ localStorage
        const debouncedNoteInput = this.debounce((event) => {
          this.handleNoteInput(event);
        }, 500);
        
        this.checklistContainer.addEventListener('input', (event) => {
          if (event.target.matches('.note-input')) {
            debouncedNoteInput(event);
          }
        });
        
        // ä½¿ç”¨äº‹ä»¶å§”æ‰˜ç›‘å¬å¯¼èˆªæŒ‰é’®ç‚¹å‡»äº‹ä»¶
        this.checklistContainer.addEventListener('click', (event) => {
          const button = event.target.closest('.nav-btn');
          if (button && !button.disabled) {
            const action = button.dataset.action;
            if (action === 'prev') {
              this.navigateToPrevious();
            } else if (action === 'next') {
              this.navigateToNext();
            } else if (action === 'complete') {
              this.showCelebration();
            }
          }
        });
        
        // ç›‘å¬é”®ç›˜å¯¼èˆªï¼ˆå·¦å³ç®­å¤´é”®ï¼‰
        document.addEventListener('keydown', (event) => {
          // å¦‚æœç„¦ç‚¹åœ¨è¾“å…¥æ¡†ä¸­ï¼Œä¸å¤„ç†ç®­å¤´é”®
          if (event.target.matches('input, textarea')) {
            return;
          }
          
          if (event.key === 'ArrowLeft') {
            event.preventDefault();
            this.navigateToPrevious();
          } else if (event.key === 'ArrowRight') {
            event.preventDefault();
            this.navigateToNext();
          }
        });
        
        // ç›‘å¬é‡ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        const resetButton = document.getElementById('resetButton');
        if (resetButton) {
          resetButton.addEventListener('click', () => {
            this.handleReset();
          });
        }
      }
    }
    
    // ==================== åº”ç”¨åˆå§‹åŒ– ====================
    
    /**
     * åº”ç”¨å¯åŠ¨å‡½æ•°
     * åœ¨ DOM åŠ è½½å®Œæˆååˆå§‹åŒ–åº”ç”¨ï¼ŒåŒ…å«å®Œæ•´çš„é”™è¯¯å¤„ç†
     */
    function startApp() {
      try {
        // åˆ›å»ºåº”ç”¨å®ä¾‹
        const app = new ChecklistApp();
        
        // åˆå§‹åŒ–åº”ç”¨
        app.init();
        
        // å°†åº”ç”¨å®ä¾‹æŒ‚è½½åˆ° window å¯¹è±¡ï¼Œä¾¿äºè°ƒè¯•
        window.checklistApp = app;
        
        console.log('æ–°è½¦è´­ä¹°æ£€æŸ¥æ¸…å•åº”ç”¨å·²å¯åŠ¨');
      } catch (e) {
        console.error('åº”ç”¨å¯åŠ¨å¤±è´¥:', e);
        
        // æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æ¶ˆæ¯
        const container = document.querySelector('.container');
        if (container) {
          const errorDiv = document.createElement('div');
          errorDiv.style.cssText = 'background-color: #fee2e2; color: #991b1b; padding: 2rem; margin: 2rem 0; border-radius: 0.5rem; text-align: center; border: 2px solid #dc2626;';
          errorDiv.innerHTML = `
            <h2 style="margin-bottom: 1rem;">åº”ç”¨å¯åŠ¨å¤±è´¥</h2>
            <p style="margin-bottom: 1rem;">æŠ±æ­‰ï¼Œåº”ç”¨æ— æ³•æ­£å¸¸å¯åŠ¨ã€‚è¯·å°è¯•ä»¥ä¸‹æ“ä½œï¼š</p>
            <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
              <li>åˆ·æ–°é¡µé¢é‡è¯•</li>
              <li>æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’Œæ•°æ®</li>
              <li>ä½¿ç”¨å…¶ä»–æµè§ˆå™¨è®¿é—®</li>
              <li>æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦å¯ç”¨äº† JavaScript</li>
            </ul>
            <p style="margin-top: 1rem; font-size: 0.875rem; opacity: 0.8;">é”™è¯¯è¯¦æƒ…: ${e.message}</p>
          `;
          
          const main = container.querySelector('main');
          if (main) {
            container.insertBefore(errorDiv, main);
          } else {
            container.appendChild(errorDiv);
          }
        }
      }
    }
    
    // ç­‰å¾… DOM åŠ è½½å®Œæˆååˆå§‹åŒ–åº”ç”¨
    if (document.readyState === 'loading') {
      // DOM è¿˜åœ¨åŠ è½½ä¸­
      document.addEventListener('DOMContentLoaded', startApp);
    } else {
      // DOM å·²ç»åŠ è½½å®Œæˆï¼ˆè„šæœ¬å»¶è¿Ÿæ‰§è¡Œçš„æƒ…å†µï¼‰
      startApp();
    }
  </script>
</body>
</html>
